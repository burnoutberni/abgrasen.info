<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Bernhard Hayden">

    <title>Abgrasen!</title>

    <style>
.site-wrapper {
  opacity:1 !important;
}

.row {
  padding:0 !important;
  margin:0 !important;
}

.row > div {
  padding:0 !important;
}

.col-md-4 {
  background-size: cover;
  background-repeat: no-repeat;
  background-position: center;
}

@media (max-width: 991px) {
  .row:nth-child(1n+2) {
    display:none;
  }
}

    </style>

    <link href='http://fonts.googleapis.com/css?family=Raleway:700' rel='stylesheet' type='text/css'>
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link href="css/abgrasen.css" rel="stylesheet">
  </head>

  <body>
    <div class="site-wrapper">
      <div class="row">
        <a><div class="col-md-4" id="tile0"></div></a>
        <a><div class="col-md-4" id="tile1"></div></a>
        <a><div class="col-md-4" id="tile2"></div></a>
      </div>
      <div class="row">
        <a><div class="col-md-4" id="tile3"></div></a>
        <a><div class="col-md-4" id="tile4"></div></a>
        <a><div class="col-md-4" id="tile5"></div></a>
      </div>
      <div class="row">
        <a><div class="col-md-4" id="tile6"></div></a>
        <a><div class="col-md-4" id="tile7"></div></a>
        <a><div class="col-md-4" id="tile8"></div></a>
      </div>
    </div>

    <div id="centeredDiv" style="position: absolute;margin: auto;left: 
0;right: 0;top: 0;pointer-events:none;">
      <h1>ABGRASEN.INFO</h1>
      <p class="lead">To add your picture make a <a style="pointer-events:auto" href="https://github.com/burnoutberni/abgrasen.info">pull request</a></p>
    </div>

    <script src="js/jquery-1.11.0.min.js"></script>
    <script src="js/bootstrap.min.js"></script>

    <script>
// Shuffle function stolen from lutoma
function shuffle(array) {
  var currentIndex = array.length, temporaryValue, randomIndex ;

  // While there remain elements to shuffle...
  while (0 !== currentIndex) {

    // Pick a remaining element...
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex -= 1;

    // And swap it with the current element.
    temporaryValue = array[currentIndex];
    array[currentIndex] = array[randomIndex];
    array[randomIndex] = temporaryValue;
  }

  return array;
}

var images = new Array()
function preload() {
  for (i = 0; i < preload.arguments.length; i++) {
    images[i] = new Image()
    images[i].src = preload.arguments[i]
  }
}

$(document).ready(function() {
  $("#centeredDiv").css("top",($(window).height()-$("#centeredDiv").height())/2);
  $(".col-md-4").height($(window).height()/3);

  var persons = [];

  //Find all img-files with Apaches index site
  $.ajax({
    url: "img/",
    success: function(data){
      var i = 0;
      $(data).find("td > a").each(function(){
        if($(this).attr("href").indexOf(".jpg") >= 0) {
          var newPerson = $(this).attr("href").split('.jpg')[0];
          persons.push(newPerson);
          preload('img/'+newPerson+'.jpg');
          i++;
        }
      });
    },
    complete: function() {
      $('#tile0').html('');
      for(var i = 0;i<9;i++) {
        shuffle(persons);
        $('#tile'+i).css('background-image','url(img/'+persons[0]+'.jpg)');
        $('#tile'+i).parent().attr('href','http://'+persons[0]+'.abgrasen.info');
      }
      setTimeout(function() {
        setInterval(function() {
          shuffle(persons);
          var j = Math.floor(Math.random() * 9);
          $('#tile'+j).css('background-image','url(img/'+persons[j]+'.jpg)');
          $('#tile'+j).parent().attr('href','http://'+persons[j]+'.abgrasen.info');
        }, 1000);
      }, 10000);
    }
  });
});

$(window).on('resize', function(){
  $("#centeredDiv").css("top",($(window).height()-$("#centeredDiv").height())/2);
  $(".col-md-4").height($(window).height()/3);
});
    </script>
  </body>
</html>

